<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Gestion de reservas</title>
    <link rel='stylesheet' type='text/css'  href='../inicio.css'>
    <link rel='stylesheet' type='text/css'  href='cliente.css'>
</head>
<body>
    
    <nav >
        <li><a class="reg" href="/index.html" id="cerrar-sesion" onclick="cerrarSesion()"> Cerrar sesion</a></li>
        <li><a class="reg" href="" id="" onclick=""> Mis turnos</a></li>
        <li><a class="reg" href="cliente.html" id="" onclick=""> Reservar turno</a></li>
    </nav>

    
    <div class="misturnos">
       

        <select id="seleccionTurno" onchange="seleccionturno2()" >
           
            <option id="misturnos"> </option>
            <option value="1">Lunes 7/6/2021 09:00 a 09:30</option>
  </select>


        <input class="boton" type="button" value="Cancelar turno" onclick="cancelarturno()"/>
        </div>
       
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <script>



     let  listaUsuarios = JSON.parse (localStorage.getItem('usuarios'));
    

     seleccionturno2=()=>{

   

/* Para obtener el texto */
var combo = document.getElementById("seleccionTurno");
var selected = combo.options[combo.selectedIndex].text;

  return(selected);
}


  
    //recorro la lista de usuarios y su coincide con el user y contraseña se ingresa al sistema
       for(u of listaUsuarios){
       if(u.conectado=="true"){
           let v=document.getElementById("misturnos").innerHTML = u.turnos;
       }
       

  
}

     cancelarturno=()=>{
      
        let  listaUsuarios = JSON.parse (localStorage.getItem('usuarios'));

  
    //recorro la lista de usuarios y su coincide con el user y contraseña se ingresa al sistema
       for(u of listaUsuarios){


        if(u.conectado && seleccionturno2()=="Lunes 7/6/2021 09:00 a 09:30" ){

        swal({
     title: "seleccione un turno valido ",
     text: "",
     icon: "warning",
     button: "Salir",
   });  

    return;
     } 


       else if(u.conectado=="true"  )
       {
      
        setTimeout(()=>{
           
   swal({
        title: "Turno cancelado",
        text: "",
        icon: "success",
        button: "Salir",
      });  

       },100)

           document.getElementById("misturnos").innerHTML = "";
           u.turnos="";
           localStorage.setItem('usuarios',JSON.stringify (listaUsuarios));
           return;
      
         
       }

       
        
    }
}

  </script> 

</body>
</html>